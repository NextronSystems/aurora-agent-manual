Configuration
=============

A default configuration file looks like this:

.. code:: yaml
 
   # Paths to your rule files
   rules-path:
      - .\rules
   # The location of log source mapping configurations
   sigma-config: 
      - .\sigma-config.yml
   # Only sigma rule matches of this level and higher will be logged (informational, low, medium, high, critical)
   reporting-level: high
   # Path in which the license file can be found (non-recursive)
   license-path: .\
   # Event matching log output streams
   eventlog: true
   events-file: %ProgramData%\Aurora-Agent\aurora-agent-events.log
   # Response actions 
   dump-path: %ProgramData%\Aurora-Agent\dumps
   # Automatically reload rules and configuration directory on changes
   auto-reload: true
   # Debugging settings (output gets only written to STDOUT and .log file)
   debug: false
   trace: false

A typical configuration file would look like this 

.. code:: yaml
 
   # Paths containing the sigma files
   rules-path:
      - C:\ProgramData\Aurora-Agent\rules
      - C:\ProgramData\Aurora-Agent\myrules
   # Automatically reload the sigma files upon detecting changes
   auto-reload: false
   # Log file path
   logfile: ""
   # Paths to the sigma configurations that should be loaded
   sigma-config:
      - C:\ProgramData\Aurora-Agent\default-log-sources.yml
      - C:\ProgramData\Aurora-Agent\etw-log-sources.yml
   # Print debugging information
   debug: false
   # Print tracing information
   trace: false
   # Log matches to the Windows event log
   eventlog: true
   # Report Sigma matches with rules of this level or higher
   minimum-level: high
   # Folder where process dumps should be stored
   dump-folder: C:\ProgramData\Aurora-Agent\process-dumps
   # Write output as JSON instead of plain text
   json: false
   # Path to the directory containing the Aurora Agent license
   license-path: C:\ProgramData\Aurora-Agent\aurora
   # UDP Address (as host:port) where the Aurora Agent should write its logs to
   udp-target: ""
   # Don't print any logs'
   silent: false
   # Percentage of a single CPU core that the Aurora Agent should use at most
   cpu-limit: 100
   # Log a message about the current agent status once per hour
   report-stats: false
   # How many log rotations should be retained
   log-rotate: 0
   # At which size the log should be rotated
   log-size: 10485760
   # Agent name that the status information pipe and the service name are based on
   agent-name: aurora-agent

Output Configuration
--------------------

The following output options are currently available 

- Log file
- Windows Eventlog
- UDP target (full version only)
- ASGARD Analysis Cockpit (full version only)
- Standard Output (debugging)

Log File (--logfile)
~~~~~~~~~~~~~~~~~~~~

The log file contains the matching events in JSON format.

Note: see the flags used for log file rotation in chapter :doc:`Usage <./usage>` for details.

Windows Eventlog (default, use --no-eventlog to disable)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If enabled by setting ``eventlog: true`` Aurora writes entries into the ``Application`` Eventlog with the ``Provider Name`` set to ``Aurora Agent``.

UDP target (--udp-target)
~~~~~~~~~~~~~~~~~~~~~~~~~

TBD

ASGARD Analysis Cockpit 
~~~~~~~~~~~~~~~~~~~~~~~

Whenever you install an ASGARD Agent, the controlled Aurora Agent Services gets its configuration automatically. In a default setup, all logs generated by an Aurora Agent will be relayed via an ASGARD Management Center to an ASGARD Analysis Cockpit system. 

Standard Output
~~~~~~~~~~~~~~~

The standard output can be used for debugging purposes. It contains all the matching events plus debugging and tracing messages when set to ``True`` in the config file. 
